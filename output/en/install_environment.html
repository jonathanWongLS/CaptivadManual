<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Xibo Documentation</title>
        <meta name="viewport" content="width=device-width">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

        <!-- favicon -->
        <link href="../img/favicon.ico" rel="shortcut icon"/>

        <!-- Bootstrap -->
        <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
        
        <!-- Stylesheets -->
        <link href="../manual.css" rel="stylesheet" media="screen">
        
        <!-- META -->
        <meta name="keywords" content="digital signage, signage, narrow-casting, xibo, open source, agpl, documentation" />
        <meta name="description" content="Xibo is an open source digital signage solution. It supports all main media types and can be interfaced to other sources of data using CSV, Databases or RSS." />
    </head>
    <body data-toc="manual_install">
        <!-- Copyright 2006-2013 Daniel Garner. Part of the Xibo Open Source Digital Signage Solution. Released under the AGPLv3 or later. -->
        <nav id="top-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#ss-navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="#" class="navbar-brand">Xibo Documentation</a>
                </div>
            
                <div class="collapse navbar-collapse" id="ss-navbar">
                    <ul class="nav navbar-nav">

                    </ul>
                </div>
            </div>
        </nav>

        <div class="ss_body container">
            <div class="row">
                <div class="col-md-3">
                    <ul id="side-nav" class="nav nav-pills nav-stacked">
                        <li><a href="index.html" data-toc-name="manual_install">Getting Started</a></li><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><ul>
<li class="active"><a href="install_environment.html">Environment<span class="glyphicon glyphicon-arrow-left you-are-here-arrow"></span></a></li>
<li><a href="install_xtr.html">XTR - Routine Tasks</a></li>
<li><a href="install_xmr.html">XMR - Push Messaging</a></li>
</ul></body></html>
<li><a href="index.html" data-toc-name="tour">Tour</a></li><li><a href="displays.html" data-toc-name="displays">Displays</a></li><li><a href="layouts.html" data-toc-name="layouts">Layouts</a></li><li><a href="media.html" data-toc-name="media">Library</a></li><li><a href="scheduling.html" data-toc-name="scheduling">Scheduling</a></li><li><a href="users.html" data-toc-name="users">Users</a></li><li><a href="advanced.html" data-toc-name="advanced">Advanced</a></li>
                    </ul>
                </div>
                <div class="col-md-9" role="main">
                    <!--toc=manual_install-->
<h1 id="prepare_your_environment">Prepare your Environment <a href="#prepare_your_environment" class="header-link"></a></h1>
<p>To run without Docker it is necessary to ensure that the environment is configured in a way
that will run Xibo. There are several things to take into consideration, such as
where to put the files, which web server to run, etc.</p>
<p>This manual cannot cover every possible environment consideration, but it does address some
common issues in the following sections.</p>
<h2 id="placing_cms_files">Placing CMS Files <a href="#placing_cms_files" class="header-link"></a></h2>
<p>Secure by design, the CMS has a folder structure which intends for only the
<code>web</code> folder to be in a location served by the web server. This means the web
server / hosting must allow files to be placed outside the web location.</p>
<p>There are several strategies for achieving this (this is not an exhaustive list):</p>
<h3>1. Modify the DocumentRoot</h3>
<p>If your document root is <code>/var/www</code>, copy the CMS into that folder and then modify the document
root to be <code>/var/www/web</code>.</p>
<h3>2. Use a symlink</h3>
<p>If your document root is <code>/var/www</code>, copy the CMS into a different folder
(for example <code>/home/user/xibo-cms</code>) and then create a link between <code>/home/user/xibo-cms/web</code>
and <code>/var/www/web</code>. Change the ownership of <code>/home/user/xibo-cms/web</code> to www-data (or the user
your web server runs under).</p>
<h3>3. Use a Virtual Host</h3>
<p>A virtual host may be used:</p>
<pre><code>&lt;VirtualHost *:80&gt;
    DocumentRoot "/var/www/web"
    ServerName www.example.com

    # Other directives here
    AllowOverride All
    Options Indexes FollowSymLinks MultiViews
    Order allow,deny
    Allow from all
    Require all granted
&lt;/VirtualHost&gt;</code></pre>
<p>Any Virtual Host configuration that points to the <code>/web</code> folder of the release archive and enables
the <code>.htaccess</code> file is sufficient.</p>
<h3>4. Use an Alias</h3>
<p>The CMS can be run under an alias - this is an example for Apache:</p>
<pre><code>Alias /xibo "/home/user/xibo-cms/web"

&lt;Directory "/home/user/xibo-cms/web"&gt;
    AllowOverride All
    Options Indexes FollowSymLinks MultiViews
    Order allow,deny
    Allow from all
    Require all granted
&lt;/Directory&gt;</code></pre>
<h2 id="url_rewriting">URL Rewriting <a href="#url_rewriting" class="header-link"></a></h2>
<p>The CMS should be run on a web server that supports URL rewriting. If this is not possible you
will need to access the application by specifying <code>index.php</code> in the URL.</p>
<h3>Apache</h3>
<p>A <code>.htaccess</code> file has been provided in <code>web/.htaccess</code>. This file assumes that the CMS is being served from the
web server document root or from a virtual host.</p>
<h4>Rewrite Rules with an Alias</h4>
<p>If an alias is required then the <code>.htaccess</code> file will need to be modified to include a <code>RewriteBase</code>
directive that matches the alias.</p>
<p>For example, if the alias is <code>/xibo</code> the <code>.htaccess</code> should have: <code>RewriteBase /xibo</code>.</p>
<h3>nginx</h3>
<p>A sample <code>nginx</code> config is provided below:</p>
<pre><code>location / {
    try_files $uri /index.php?$args;
}

location /api/authorize {
    try_files $uri /api/authorize/index.php?args;
}

location /api {
    try_files $uri /api/index.php?$args;
}

location /install {
    try_files $uri /install/index.php?$args;
}

location /maint {
    try_files $uri /maint/index.php?$args;
}

location /maintenance {
    try_files $uri /index.php?$args;
}
</code></pre>
<h3>IIS</h3>
<p>IIS includes a function to convert from <code>.htaccess</code> which creates the correct configuration for IIS. However,
the error message <code>Error IIS MAP RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]</code> may be
received.</p>
<p>This rule is incompatible with IIS and can be removed.</p>
<p>After import the following content will be inserted into the <code>web.config</code> file.</p>
<pre><code>&lt;system.webServer&gt;
    &lt;rewrite&gt;
        &lt;rules&gt;
            &lt;rule name="Imported Rule 1" stopProcessing="true"&gt;
                &lt;match url="^" ignoreCase="false" /&gt;
                &lt;conditions logicalGrouping="MatchAll"&gt;
                    &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" /&gt;
                    &lt;add input="{URL}" pattern="^.*/authorize/.*$" ignoreCase="false" /&gt;
                &lt;/conditions&gt;
                &lt;action type="Rewrite" url="api/authorize/index.php" appendQueryString="true" /&gt;
            &lt;/rule&gt;
            &lt;rule name="Imported Rule 2" stopProcessing="true"&gt;
                &lt;match url="^" ignoreCase="false" /&gt;
                &lt;conditions logicalGrouping="MatchAll"&gt;
                    &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" /&gt;
                    &lt;add input="{URL}" pattern="^.*/api/.*$" ignoreCase="false" /&gt;
                &lt;/conditions&gt;
                &lt;action type="Rewrite" url="api/index.php" appendQueryString="true" /&gt;
            &lt;/rule&gt;
            &lt;rule name="Imported Rule 3" stopProcessing="true"&gt;
                &lt;match url="^" ignoreCase="false" /&gt;
                &lt;conditions logicalGrouping="MatchAll"&gt;
                    &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" /&gt;
                    &lt;add input="{URL}" pattern="^.*/install/.*$" ignoreCase="false" /&gt;
                &lt;/conditions&gt;
                &lt;action type="Rewrite" url="install/index.php" appendQueryString="true" /&gt;
            &lt;/rule&gt;
            &lt;rule name="Imported Rule 4" stopProcessing="true"&gt;
                &lt;match url="^" ignoreCase="false" /&gt;
                &lt;conditions logicalGrouping="MatchAll"&gt;
                    &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" /&gt;
                    &lt;add input="{URL}" pattern="^.*/maint/.*$" ignoreCase="false" /&gt;
                &lt;/conditions&gt;
                &lt;action type="Rewrite" url="maint/index.php" appendQueryString="true" /&gt;
            &lt;/rule&gt;
            &lt;rule name="Imported Rule 5" stopProcessing="true"&gt;
                &lt;match url="^" ignoreCase="false" /&gt;
                &lt;conditions logicalGrouping="MatchAll"&gt;
                    &lt;add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" /&gt;
                &lt;/conditions&gt;
                &lt;action type="Rewrite" url="index.php" appendQueryString="true" /&gt;
            &lt;/rule&gt;
        &lt;/rules&gt;
    &lt;/rewrite&gt;
&lt;/system.webServer&gt;</code></pre>
<p><a id="zeroMQ"></a></p>
<h2 id="zeromq">ZeroMQ <a href="#zeromq" class="header-link"></a></h2>
<p><a href="http://zeromq.org/">ZeroMQ</a> is a low level library used by Xibo to
manage push messaging between the CMS and Players. The ZeroMQ PHP bindings are
required for this to function. XMR will not run without ZeroMQ installed.</p>
<p>Installation of the ZeroMQ bindings can be complicated - we've included an example
of installation on Ubuntu 14.04. We recommend using our Docker container for
easy installation.</p>
<h3>Install the ZeroMQ core and PHP bindings from PPA</h3>
<p>Installation via <code>apt-get</code>.</p>
<pre><code class="language-bash">sudo add-apt-repository ppa:chris-lea/zeromq
sudo add-apt-repository ppa:alexharrington/php-zmq
sudo apt-get update
sudo apt-get install php5-zmq</code></pre>
<h3>Install the ZeroMQ PHP bindings manually</h3>
<p>If you can't install from the PPA directly, then you can do the following to
install the zmq extension.</p>
<p>Installation via <code>PECL</code>.</p>
<pre><code class="language-bash">sudo add-apt-repository ppa:chris-lea/zeromq
sudo apt-get install libzmq3 libzmq3-dev libzmq3-dbg pkg-config php5-dev build-essential php-pear
sudo pecl install zmq-beta</code></pre>
<p>Add the <code>extension=zmq.so</code> directive to your <code>php.ini</code> file and restart your
web server.</p>
                </div>
            </div>
        </div> <!-- container-->
        <footer class="ss_footer" role="contentinfo">
            <div class="container">
                <div class="pull-right">
                    <img class="img-responsive logo" src="../img/logo.png" alt="Xibo" />
                </div>

                <p class="ss_back_to_top">Back to Top</p>

                <p>Designed and built by <a href="http://springsignage.com/">Spring Signage</a> for the <a href="http://www.xibo.org.uk" target="_blank">Xibo Project</a>.</p>
                <p>Open Source Code licensed under <a href="" target="_blank">GNU Affero General Public License v3 or later</a>, documentation under <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.0/uk/" target="_blank">Creative Commons Licence</a>.</p>

                <p class="ss_footer_links">Currently v1.8.4</p>

                <p class="ss_languages"><a href="../en/index.html">en</a> | <a href="../fr/index.html">fr</a></p>
            </div>
        </footer>

        <!-- JavaScript -->
        <script src="../vendor/jquery/jquery-1.9.1.js"></script>
        <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $(".ss_body img").addClass("img-thumbnail");
                $(".ss_body table").addClass("table");

                // Set the selected page based on the TOC name
                // Mark the appropriate top nav element as the selected page
                $("#side-nav a").each(function() {
                    if ($(this).data().tocName == $("body").data().toc)
                        $(this).parent().addClass("active");
                });

                $(".ss_back_to_top").click(function() {
                    $('html, body').animate({scrollTop : 0},800);
                });

                if (inIframe()) {
                    console.log("In Frame");
                    $("#top-nav").css("display", "none");
                    $(".ss-sidebar").parent().css("display", "none");
                }
            });

            function inIframe () {
                try {
                    return window.self !== window.top;
                } catch (e) {
                    return true;
                }
            }
        </script>
    </body>
</html>
