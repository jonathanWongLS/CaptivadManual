<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Xibo Documentation</title>
        <meta name="viewport" content="width=device-width">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

        <!-- favicon -->
        <link href="../img/favicon.ico" rel="shortcut icon"/>

        <!-- Bootstrap -->
        <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
        
        <!-- Stylesheets -->
        <link href="../manual.css" rel="stylesheet" media="screen">
        
        <!-- META -->
        <meta name="keywords" content="digital signage, signage, narrow-casting, xibo, open source, agpl, documentation" />
        <meta name="description" content="Xibo is an open source digital signage solution. It supports all main media types and can be interfaced to other sources of data using CSV, Databases or RSS." />
    </head>
    <body data-toc="cms_installation">
        <!-- Copyright 2006-2013 Daniel Garner. Part of the Xibo Open Source Digital Signage Solution. Released under the AGPLv3 or later. -->
        <nav id="top-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#ss-navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a href="#" class="navbar-brand">Xibo Documentation</a>
                </div>
            
                <div class="collapse navbar-collapse" id="ss-navbar">
                    <ul class="nav navbar-nav">

                    </ul>
                </div>
            </div>
        </nav>

        <div class="ss_body container">
            <div class="row">
                <div class="col-md-3">
                    <ul id="side-nav" class="nav nav-pills nav-stacked">
                        <li><a href="index.html" data-toc-name="cms_installation">Getting Started</a></li><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><ul>
<li><a href="install_cms.html">CMS Installation</a></li>
<li class="active"><a href="install_docker_linux.html">Docker on Linux<span class="glyphicon glyphicon-arrow-left you-are-here-arrow"></span></a></li>
<li><a href="install_docker_win10_64bit.html">Docker on Windows 10 64bit</a></li>
<li><a href="install_docker_winother_64bit.html">Docker on other Windows 64bit</a></li>
<li><a href="install_docker_without_compose.html">Docker on an existing Docker cluster</a></li>
<li><a href="manual_install.html">On a Web server</a></li>
<li><a href="install_custom_content.html">Custom scripts and pages</a></li>
</ul></body></html>
<li><a href="index.html" data-toc-name="tour">Tour</a></li><li><a href="displays.html" data-toc-name="displays">Displays</a></li><li><a href="layouts.html" data-toc-name="layouts">Layouts</a></li><li><a href="media.html" data-toc-name="media">Library</a></li><li><a href="scheduling.html" data-toc-name="scheduling">Scheduling</a></li><li><a href="users.html" data-toc-name="users">Users</a></li><li><a href="advanced.html" data-toc-name="advanced">Advanced</a></li>
                    </ul>
                </div>
                <div class="col-md-9" role="main">
                    <!--toc=cms_installation-->
<h1 id="docker_on_linux">Docker on Linux <a href="#docker_on_linux" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h1>
<p><a href="https://docker.com/">Docker</a> is an application to package and run any
application in a pre-configured container making it much easier to deploy
a Xibo CMS with recommended configuration.</p>
<h2 id="install_docker">Install Docker <a href="#install_docker" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>Docker can be installed on 64 bit Linux based systems by following the
instructions for your particular Linux distribution. You should install the
Stable build, and install Docker CE (Community Edition) unless you have a
pre-existing Docker EE (Enterprise Edition) install, or wish to explore that
option.</p>
<p>The instructions for installing Docker can be found on the Docker website in
the following location: <a href="https://docs.docker.com/engine/installation/">Docker Install for Linux
Distributions</a></p>
<p>On Linux is it also necessary to install Docker Compose as it is not shipped
with the above package. To do so visit <a href="https://github.com/docker/compose/releases/latest">Docker
Releases</a> and run the
commands indicated on the latest release.</p>
<h2 id="download_and_extract_the_xibo_docker_archive">Download and extract the Xibo Docker archive <a href="#download_and_extract_the_xibo_docker_archive" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>The latest Xibo Docker installation files can be <a href="https://github.com/xibosignage/xibo-cms/releases/download/1.8.4/xibo-docker.tar.gz">downloaded
from our website</a>.</p>
<p>The archive should be extracted in a suitable location on your host machine
we'd suggest <code>/opt/Xibo</code>. The <code>docker</code> user must be able to read and write to
this folder. Your library content and database will be written under this
folder.</p>
<p>Please note that the archive already contains a sub-folder called Xibo-docker, which is best practice for archives! For the subsequent instructions please make sure you are <em>inside</em> the sub-folder contained in the archive.</p>
<h2 id="check_and_edit_configuration">Check and edit configuration <a href="#check_and_edit_configuration" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>The first time Xibo is installed a configuration file is needed to
tell Docker how the environment is configured. This file is called <code>config.env</code>.
This file covers where you want files to be stored, email config, etc.</p>
<p>A template file with detailed instructions is provided in the release archive
and is called <code>config.env.template</code>. Take a copy of this file, renaming to
<code>config.env</code> and then edit the file in a text editor, e.g. nano, gedit, etc.</p>
<p>If you don't want Xibo to be able to send email messages, then you
can omit to configure those options.</p>
<p>Docker will map data folders to contain database data and any custom files for
the CMS. These will default appear in the folder containing the release archive
in a <code>shared</code> sub-folder.</p>
<h3>Using different ports</h3>
<p>By default, Xibo will start a web server listening on port 80. If you
already have a web server listening on port 80 of your host machine, or would
prefer to use an alternative port number, then you need to copy the
<code>cms_custom-ports.yml.template</code> file and change the <code>ports</code> section for
<code>cms-web</code>. The file should be saved as <code>cms_custom-ports.yml</code>.</p>
<p>Similarly, Xibo's XMR server will be started listening on port 9505.
If you would prefer to use an alternative port number, then you'll need to do so
by copying the <code>cms_custom-ports.yml.template</code> file and changing the <code>ports</code>
section for <code>cms-xmr</code>.</p>
<p>The ports section of a Docker Compose YML file lists ports in the format
<code>&lt;host&gt;:&lt;container&gt;</code> - to move to port 8080 the declaration would be <code>8080:80</code>.</p>
<p>To use this file replace any <code>docker-compose up -d</code> commands in the below
instructions with <code>docker-compose -f cms_custom-ports.yml up -d</code>.</p>
<h3>Remote MySQL</h3>
<p>The default <code>docker-compose.yml</code> file includes a container for MySQL, however it
is possible to run with an external / remote MySQL instance as the database for
Xibo.</p>
<p>To do this base the <code>config.env</code> file on the template
<code>config.evn.template-remote-mysql</code> and replace any <code>docker-compose up -d</code>
commands in the below instructions with <code>docker-compose -f cms_remote-mysql.yml up -d</code>.</p>
<h3>HTTPS/SSL</h3>
<p>Xibo should be run over SSL if running on anything other than a
secure private network. The Docker containers do not provide SSL and this must
be provided by an external web server which handles SSL termination and reverse
proxy into the <code>cms-web</code> container.</p>
<p>There are many good resources for achieving this architecture - for example a
<a href="https://github.com/jwilder/nginx-proxy">nginx-proxy container</a> could be used.</p>
<p>If you already have a web server running on your Host machine, configuring a
reverse proxy should be straightforward, an example <code>VirtualHost</code> for Apache is
below, it assumes you've configured your custom ports for port 8080:</p>
<pre><code>Listen 443

NameVirtualHost *:443
&lt;VirtualHost *:443&gt;

    SSLEngine On
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto "https"

    # Set the path to SSL certificate
    # Usage: SSLCertificateFile /path/to/cert.pem
    SSLCertificateFile /etc/apache2/ssl/file.pem

    # Servers to proxy the connection, or;
    # List of application servers:
    # Usage:
    # ProxyPass / http://[IP Addr.]:[port]/
    # ProxyPassReverse / http://[IP Addr.]:[port]/
    # Example:
    ProxyPass / http://0.0.0.0:8080/
    ProxyPassReverse / http://0.0.0.0:8080/

&lt;/VirtualHost&gt;</code></pre>
<p>A worked example for setting up an Apache reverse proxy for SSL with LetsEncrypt
SSL certificates can be found
<a href="https://community.xibo.org.uk/t/xibo-1-8-0-with-docker-on-ubuntu-16-04/9392">here</a>.</p>
<h2 id="installing_the_cms_containers">Installing the CMS containers <a href="#installing_the_cms_containers" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>Once you've made your changes to <code>config.env</code> and have saved the file, Open a
terminal/command window in the folder where you extracted the archive. As a user
who has permissions to run the <code>docker</code> command, simply run:</p>
<pre><code>docker-compose up -d</code></pre>
<p>This will bootstrap and start your Xibo CMS. The CMS will be fully
installed with the default credentials.</p>
<pre><code>Username: Xibo_admin
Password: password</code></pre>
<p>You should log on to the CMS straight away and change the password on that
account.</p>
<p>You can log on to the CMS at <code>http://localhost</code>. If you configured an
alternative port number then be sure to add that to the URL, for example
<code>http://localhost:8080</code>.</p>
<h2 id="configuration_adjustments">Configuration adjustments <a href="#configuration_adjustments" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>If you are running an iptables based firewall on your computer you will need to
allow the ports you've configured the CMS to run on inbound. If you haven't
specifically configured alternative ports, then the following is required:</p>
<ul>
<li>Inbound TCP Port 9505 (for XMR Push Messaging)</li>
<li>Inbound TCP Port 80 (for HTTP Traffic) AND/OR</li>
<li>Inbound TCP Port 443 (for HTTPS Traffic - if you are using SSL)</li>
</ul>
<h3>Configuration of XMR public address</h3>
<p>Docker cannot reasonably know the DNS name or IP address of your host machine,
and therefore it is necessary to configure the XMR Public Address in CMS
Settings when first logged in. <strong>This only needs to be done on the first
bootstrap</strong>.</p>
<p>This can be found on the CMS Settings page under Administration, on the Display
tab.</p>
<p>The format of the address is:</p>
<pre><code>tcp://&lt;ip_address&gt;:&lt;port&gt;</code></pre>
<p>The default <code>&lt;port&gt;</code> is 9505 and should be set to that unless you have specified
a custom port in your docker-compose configuration.</p>
<h2 id="starting_and_stopping_xibo">Starting and Stopping Xibo <a href="#starting_and_stopping_xibo" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>Once the CMS containers have been initialised with <code>docker-compose up -d</code>, it
is possible to start and stop them without removing the underlying container.</p>
<p>The <code>stop</code> command will stop the Xibo CMS services running. If you
want to start them up again, issue the <code>start</code> command.</p>
<pre><code>docker-compose stop
docker-compose start</code></pre>
<h2 id="uninstalling_/_removing">Uninstalling / removing <a href="#uninstalling_/_removing" class="header-link"><span class="glyphicon glyphicon-link"></span></a></h2>
<p>The CMS installation and its associated containers can be completely removed by
issuing the <code>down</code> command.</p>
<p><strong> Before running docker-compose down</strong>, please be sure that your media and
database files are being correctly written to the <code>shared</code> directory. To do so,
upload for example an image in to the CMS, and check that the same image
appears in the <code>shared/cms/library</code> directory. Another good check is to make
sure that <code>shared/backup/db/latest.tar.gz</code> was created within the last 24
hours. If either of those checks fail, please do not run <code>docker-compose down</code> as this will lead to data loss. Seek support to resolve the situation.</p>
<p>If your intention is to remove all traces of Xibo you may delete
the <code>/opt/xibo</code> folder <strong>after</strong> running the <code>down</code> command.</p>
<pre><code>docker-compose down</code></pre>
                </div>
            </div>
        </div> <!-- container-->
        <footer class="ss_footer" role="contentinfo">
            <div class="container">
                <div class="pull-right">
                    <img class="img-responsive logo" src="../img/logo.png" alt="Xibo" />
                </div>

                <p class="ss_back_to_top">Back to Top</p>

                <p>Designed and built by <a href="http://springsignage.com/">Spring Signage</a> for the <a href="http://www.xibo.org.uk" target="_blank">Xibo Project</a>.</p>
                <p>Open Source Code licensed under <a href="" target="_blank">GNU Affero General Public License v3 or later</a>, documentation under <a rel="license" href="http://creativecommons.org/licenses/by-sa/2.0/uk/" target="_blank">Creative Commons Licence</a>.</p>

                <p class="ss_footer_links">Currently v1.8.4</p>

                <p class="ss_languages"><a href="../en/index.html">en</a> | <a href="../fr/index.html">fr</a></p>
            </div>
        </footer>

        <!-- JavaScript -->
        <script src="../vendor/jquery/jquery-1.9.1.js"></script>
        <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function() {
                $(".ss_body img").addClass("img-thumbnail");
                $(".ss_body table").addClass("table");

                // Set the selected page based on the TOC name
                // Mark the appropriate top nav element as the selected page
                $("#side-nav a").each(function() {
                    if ($(this).data().tocName == $("body").data().toc)
                        $(this).parent().addClass("active");
                });

                $(".ss_back_to_top").click(function() {
                    $('html, body').animate({scrollTop : 0},800);
                });

                if (inIframe()) {
                    console.log("In Frame");
                    $("#top-nav").css("display", "none");
                    $(".ss-sidebar").parent().css("display", "none");
                }
            });

            function inIframe () {
                try {
                    return window.self !== window.top;
                } catch (e) {
                    return true;
                }
            }
        </script>
    </body>
</html>
